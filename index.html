<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="David R. Slochower">
  <meta name="dcterms.date" content="2017-11-28">
  <meta name="keywords" content="work-in-progress, markdown, manuscript, publishing">
  <title>Nonequilibrium molecular motors: optimization and torque</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="github-pandoc.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!-- Insert Analytics Script Below -->
  <script>
  </script>
  <!-- End Analytics Script -->
</head>
<body>
<header>
<h1 class="title">Nonequilibrium molecular motors: optimization and torque</h1>
</header>
<p><small><em> This manuscript was automatically generated from <a href="https://github.com/slochower/nonequilibrium-barrier/tree/9244179633f35b61bd0c69cfddcc0698ce17ed12">slochower/nonequilibrium-barrier@9244179</a> on November 28, 2017. </em></small></p>
<h2 id="optimization-of-the-potential-energy-surfaces">Optimization of the potential energy surfaces</h2>
<p>It would be nice to be able to design – or suggest how to design – a molecular motor for specific properties: speed, force, torque, gearing, ability to work against a load, resistance to being forced backwards, or something else. To that end, we set out to explore the relationship between the shape of the potential energy surfaces and these properties.</p>
<h3 id="optimization-of-a-single-surface-for-maximal-flux">Optimization of a single surface for maximal flux</h3>
<figure>
<img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/292d5ab98a15e4dfff6ef56d7dc4b7f13764ae11/notebooks/surface-optimization/bound-presmoothing-surface.svg" alt="Figure 1: The fixed bound potential energy surface, based on a sawtooth wave. It is a little misleading, but this curve is actually only the seven points in red, drawn on a scale of 60, to show how the seven points map to the interpolated spline below. That is, the bound state is the curve consisting of the points {(0, 3), (10, 4), (20, 5), (30, 0), (40, 1), (50, 2), (59, 3)} interpolated to 60 bins using the spline." id="fig:bound-presmooth" width="377" /><figcaption>Figure 1: The fixed bound potential energy surface, based on a sawtooth wave. It is a little misleading, but this curve is actually only the seven points in red, drawn on a scale of 60, to show how the seven points map to the interpolated spline below. That is, the bound state is the curve consisting of the points <code>{(0, 3), (10, 4), (20, 5), (30, 0), (40, 1), (50, 2), (59, 3)}</code> interpolated to 60 bins using the spline.</figcaption>
</figure>
<figure>
<img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/bcac92c96f496a888dc02249e40d049032225205/notebooks/surface-optimization/fixed-bound-surfaces.svg" alt="Figure 2: The fixed bound potential energy surface after splining." id="fig:bound" width="377" /><figcaption>Figure 2: The fixed bound potential energy surface after splining.</figcaption>
</figure>
<p>To start, let’s begin with a fixed bound energy surface created by smoothing a sawtooth with seven spline points (Figure <a href="#fig:bound">2</a>). I couldn’t find a way to spline across the periodic boundary, so the curve looks a little wonkier than expected. My first attempt was to use a downhill simplex method (<a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">Nelder-Mead</a>) to optimize the apo surface for maximal flux. The algorithm begins with an initial guess of a flat apo surface. The results are not completely deterministic, even with with setting <code>np.random.seed(42)</code>, and I don’t understand that. After 100 loops of the same optimization, using the same initial conditions and random seed, the number of function evaluations in each optimization bounces between around 1400 and around 500! I could look into this further, but I haven’t. It may have to do with the interpolation.</p>
<figure>
<img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/d346ae563e1c9b584b87695cc431defd14530f5a/notebooks/surface-optimization/nelder-mead-evaluations.svg" alt="Figure 3: In my hands, the Nelder-Mead optimization is not completely deterministic." id="fig:nelder-mead" width="377" /><figcaption>Figure 3: In my hands, the Nelder-Mead optimization is not completely deterministic.</figcaption>
</figure>
<figure>
<img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/292d5ab98a15e4dfff6ef56d7dc4b7f13764ae11/notebooks/surface-optimization/optimized-apo-surfaces.png" alt="Figure 4: The result of the optimized apo potential energy surface." id="fig:optimized" width="377" /><figcaption>Figure 4: The result of the optimized apo potential energy surface.</figcaption>
</figure>
<p>After 1403 iterations, Nelder-Mead optimization results in the surface shown in Figure <a href="#fig:optimized">4</a>. Each blue line is an iteration of the optimization. Lighter colors correspond to earlier iterations. The final surface is darker because many lines are overlaid. I have not implemented bounds on the optimization because Nelder-Mead does not allow bounds, as far as I know. I’ll return to the idea of using bounds a little later. The result of this optimization is that the flux starts near <span class="math inline">0</span> (although not exactly at zero, curiously) and drops to <span class="math inline">−0.050 cycle s<sup>−1</sup></span> quickly and stays there.</p>
<figure>
<img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/292d5ab98a15e4dfff6ef56d7dc4b7f13764ae11/notebooks/surface-optimization/flux-iterations.png" alt="Figure 5: The flux during optimization." id="fig:optimized-flux" width="377" /><figcaption>Figure 5: The flux during optimization.</figcaption>
</figure>
<p>COBYLA and Powell’s method result in better optimization than simplex downhill. After 269 iterations, COBYLA approaches flux of more than <span class="math inline">−250 cycle s<sup>−1</sup></span>, with the flux beginning to decrease after just a few iterations. The iterations of COBYLA look like they are refining a single landscape, instead of jumping around. Powell’s method does well, too, although it occasionally jumps back to near zero flux after finding a high value.</p>
<p>Taken together, the fixed bound surface and the COBYLA-optimized apo surface are shown below.</p>
<p><img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/01269a9f99c5d5858c1b903fb72b34c390c5f3b0/notebooks/surface-optimization/COBYLA-optimized-surfaces.png" alt="The COBYLA-optimized energy surfaces." id="fig:cobyla-optimized-surfaces" width="377" /> <img src="https://cdn.rawgit.com/slochower/nonequilibrium-master/01269a9f99c5d5858c1b903fb72b34c390c5f3b0/notebooks/surface-optimization/COBYLA-optimized-flux.png" alt="The COBYLA-optimized energy surfaces." id="fig:cobyla-optimized-flux" width="377" /></p>
<h3 id="optimization-of-both-surfaces-for-maximal-flux">Optimization of both surfaces for maximal flux</h3>
<p>COBYLA in particular handles the bounds and produces highly optimized surfaces after just a few iterations.</p>
<h2 id="optimization-of-a-surface-for-maximum-force">Optimization of a surface for maximum force</h2>
<h2 id="the-force-on-a-barrier">The force on a barrier</h2>
<p>It is interesting that in most places <span class="math inline"><em>F</em> = 0</span>.</p>
<h2 id="outline">Outline</h2>
<ol type="1">
<li><p>Surface with and without a barrier</p></li>
<li><p>Family of curves showing force on the barrier as a function of height and position of the barrier.</p></li>
<li><p>Optimization of a surface for flux and force with and without a barrier.</p></li>
</ol>
<h3 id="ideas">Ideas</h3>
<ol type="1">
<li><p>MD and umbrella sampling of a Feringa-type motor.</p></li>
<li><p>pH change can be modeled as a change in substrate concentration, for our purposes.</p></li>
<li><p>Can the experimental groups synthesize motors based on an energy surface?</p></li>
<li><p>CD can be a platform – a scaffold – for building, but it will be hard to figure out the appropriate assays.</p></li>
</ol>
<script>
// AnchorJS minified version below.
// Source https://github.com/bryanbraun/anchorjs/blob/064abdd0987f305933ec4982af6d0c1cf2fd0814/anchor.js

/**
 * AnchorJS - v4.0.0 - 2017-06-02
 * https://github.com/bryanbraun/anchorjs
 * Copyright (c) 2017 Bryan Braun; Licensed MIT
 */
!function(A,e){"use strict";"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():(A.AnchorJS=e(),A.anchors=new A.AnchorJS)}(this,function(){"use strict";function A(A){function e(A){A.icon=A.hasOwnProperty("icon")?A.icon:"",A.visible=A.hasOwnProperty("visible")?A.visible:"hover",A.placement=A.hasOwnProperty("placement")?A.placement:"right",A.class=A.hasOwnProperty("class")?A.class:"",A.truncate=A.hasOwnProperty("truncate")?Math.floor(A.truncate):64}function t(A){var e;if("string"==typeof A||A instanceof String)e=[].slice.call(document.querySelectorAll(A));else{if(!(Array.isArray(A)||A instanceof NodeList))throw new Error("The selector provided to AnchorJS was invalid.");e=[].slice.call(A)}return e}function n(){if(null===document.head.querySelector("style.anchorjs")){var A,e=document.createElement("style");e.className="anchorjs",e.appendChild(document.createTextNode("")),void 0===(A=document.head.querySelector('[rel="stylesheet"], style'))?document.head.appendChild(e):document.head.insertBefore(e,A),e.sheet.insertRule(" .anchorjs-link {   opacity: 0;   text-decoration: none;   -webkit-font-smoothing: antialiased;   -moz-osx-font-smoothing: grayscale; }",e.sheet.cssRules.length),e.sheet.insertRule(" *:hover > .anchorjs-link, .anchorjs-link:focus  {   opacity: 1; }",e.sheet.cssRules.length),e.sheet.insertRule(" [data-anchorjs-icon]::after {   content: attr(data-anchorjs-icon); }",e.sheet.cssRules.length),e.sheet.insertRule(' @font-face {   font-family: "anchorjs-icons";   src: url(data:n/a;base64,AAEAAAALAIAAAwAwT1MvMg8yG2cAAAE4AAAAYGNtYXDp3gC3AAABpAAAAExnYXNwAAAAEAAAA9wAAAAIZ2x5ZlQCcfwAAAH4AAABCGhlYWQHFvHyAAAAvAAAADZoaGVhBnACFwAAAPQAAAAkaG10eASAADEAAAGYAAAADGxvY2EACACEAAAB8AAAAAhtYXhwAAYAVwAAARgAAAAgbmFtZQGOH9cAAAMAAAAAunBvc3QAAwAAAAADvAAAACAAAQAAAAEAAHzE2p9fDzz1AAkEAAAAAADRecUWAAAAANQA6R8AAAAAAoACwAAAAAgAAgAAAAAAAAABAAADwP/AAAACgAAA/9MCrQABAAAAAAAAAAAAAAAAAAAAAwABAAAAAwBVAAIAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAMCQAGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAg//0DwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAAIAAAACgAAxAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADAAAAAIAAgAAgAAACDpy//9//8AAAAg6cv//f///+EWNwADAAEAAAAAAAAAAAAAAAAACACEAAEAAAAAAAAAAAAAAAAxAAACAAQARAKAAsAAKwBUAAABIiYnJjQ3NzY2MzIWFxYUBwcGIicmNDc3NjQnJiYjIgYHBwYUFxYUBwYGIwciJicmNDc3NjIXFhQHBwYUFxYWMzI2Nzc2NCcmNDc2MhcWFAcHBgYjARQGDAUtLXoWOR8fORYtLTgKGwoKCjgaGg0gEhIgDXoaGgkJBQwHdR85Fi0tOAobCgoKOBoaDSASEiANehoaCQkKGwotLXoWOR8BMwUFLYEuehYXFxYugC44CQkKGwo4GkoaDQ0NDXoaShoKGwoFBe8XFi6ALjgJCQobCjgaShoNDQ0NehpKGgobCgoKLYEuehYXAAAADACWAAEAAAAAAAEACAAAAAEAAAAAAAIAAwAIAAEAAAAAAAMACAAAAAEAAAAAAAQACAAAAAEAAAAAAAUAAQALAAEAAAAAAAYACAAAAAMAAQQJAAEAEAAMAAMAAQQJAAIABgAcAAMAAQQJAAMAEAAMAAMAAQQJAAQAEAAMAAMAAQQJAAUAAgAiAAMAAQQJAAYAEAAMYW5jaG9yanM0MDBAAGEAbgBjAGgAbwByAGoAcwA0ADAAMABAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAH//wAP) format("truetype"); }',e.sheet.cssRules.length)}}this.options=A||{},this.elements=[],e(this.options),this.isTouchDevice=function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},this.add=function(A){var i,o,s,c,r,a,h,l,u,d,f,g,p=[];if(e(this.options),"touch"===(g=this.options.visible)&&(g=this.isTouchDevice()?"always":"hover"),A||(A="h2, h3, h4, h5, h6"),0===(i=t(A)).length)return this;for(n(),o=document.querySelectorAll("[id]"),s=[].map.call(o,function(A){return A.id}),r=0;r<i.length;r++)if(this.hasAnchorJSLink(i[r]))p.push(r);else{if(i[r].hasAttribute("id"))c=i[r].getAttribute("id");else if(i[r].hasAttribute("data-anchor-id"))c=i[r].getAttribute("data-anchor-id");else{u=l=this.urlify(i[r].textContent),h=0;do{void 0!==a&&(u=l+"-"+h),a=s.indexOf(u),h+=1}while(-1!==a);a=void 0,s.push(u),i[r].setAttribute("id",u),c=u}d=c.replace(/-/g," "),(f=document.createElement("a")).className="anchorjs-link "+this.options.class,f.href="#"+c,f.setAttribute("aria-label","Anchor link for: "+d),f.setAttribute("data-anchorjs-icon",this.options.icon),"always"===g&&(f.style.opacity="1"),""===this.options.icon&&(f.style.font="1em/1 anchorjs-icons","left"===this.options.placement&&(f.style.lineHeight="inherit")),"left"===this.options.placement?(f.style.position="absolute",f.style.marginLeft="-1em",f.style.paddingRight="0.5em",i[r].insertBefore(f,i[r].firstChild)):(f.style.paddingLeft="0.375em",i[r].appendChild(f))}for(r=0;r<p.length;r++)i.splice(p[r]-r,1);return this.elements=this.elements.concat(i),this},this.remove=function(A){for(var e,n,i=t(A),o=0;o<i.length;o++)(n=i[o].querySelector(".anchorjs-link"))&&(-1!==(e=this.elements.indexOf(i[o]))&&this.elements.splice(e,1),i[o].removeChild(n));return this},this.removeAll=function(){this.remove(this.elements)},this.urlify=function(A){var t=/[& +$,:;=?@"#{}|^~[`%!'<>\]\.\/\(\)\*\\]/g;return this.options.truncate||e(this.options),A.trim().replace(/\'/gi,"").replace(t,"-").replace(/-{2,}/g,"-").substring(0,this.options.truncate).replace(/^-+|-+$/gm,"").toLowerCase()},this.hasAnchorJSLink=function(A){var e=A.firstChild&&(" "+A.firstChild.className+" ").indexOf(" anchorjs-link ")>-1,t=A.lastChild&&(" "+A.lastChild.className+" ").indexOf(" anchorjs-link ")>-1;return e||t||!1}}return A});

// Enable links for selected headers
var anchors = new AnchorJS();
anchors.add("h2, h3, h4")
</script>
</body>
</html>
