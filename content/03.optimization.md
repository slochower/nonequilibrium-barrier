## Optimization of the potential energy surfaces

It would be nice to be able to design -- or suggest how to design -- a molecular motor for specific properties (speed, force, torque, gearing, ability to work against a load, resistance to being forced backwards, or something else).
To that end, we set out to explore the relationship between the shape of the potential energy surfaces and these properties. [@doi:10.1126/science.1127344]

### Optimization of a single surface for maximal flux

![The fixed bound potential energy surface, based on a sawtooth wave.](https://github.com/slochower/nonequilibrium-master/blob/292d5ab98a15e4dfff6ef56d7dc4b7f13764ae11/notebooks/surface-optimization/bound-presmoothing-surface.svg){#fig:bound-presmooth width=10cm}

![The fixed bound potential energy surface after splining.](https://cdn.rawgit.com/slochower/nonequilibrium-master/bcac92c96f496a888dc02249e40d049032225205/notebooks/surface-optimization/fixed-bound-surfaces.svg){#fig:bound width=10cm}

To start, let's begin with a fixed bound energy surface created by smoothing a sawtooth with seven spline points @fig:bound.
I couldn't find a way to spline across the periodic boundary, so the curve looks a little wonkier than expected.
My first attempt was to use a downhill simplex method ([Nelder-Mead optimization](https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method)) to optimize the two surfaces together for flux.
The results are not completely deterministic, even with with setting `np.random.seed(42)`, and I don't understand that.

### Two surfaces, both optimized (?)

## Optimization of a surface for maximum force

